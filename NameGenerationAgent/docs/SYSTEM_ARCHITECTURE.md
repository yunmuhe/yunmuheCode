# 智能姓名生成系统架构文档

## 系统概述

智能姓名生成系统是一个基于多平台大模型API的智能姓名生成工具，能够根据用户提供的角色描述生成符合要求的姓名，并提供丰富的语料库支持。

## 系统架构

### 1. 核心组件

#### 1.1 姓名生成器 (NameGenerator)
- 位于: `src/core/name_generator.py`
- 功能:
  - 集成多平台API（通义千问、讯飞星火等）
  - 支持多种文化风格（现代中文、传统中文、奇幻、西方等）
  - 支持性别和年龄选项
  - 提供缓存机制提高性能
  - 集成语料库增强功能

#### 1.2 语料库增强器 (CorpusEnhancer)
- 位于: `src/core/corpus_enhancer.py`
- 功能:
  - 加载和管理多种类型语料库数据
  - 提供语料库统计信息
  - 增强提示词生成质量
  - 支持成语姓名生成

#### 1.3 统一API客户端 (UnifiedClient)
- 位于: `src/api/unified_client.py`
- 功能:
  - 提供统一的API调用接口
  - 支持多种大模型平台
  - 实现适配器模式
  - 处理API错误和重试机制

#### 1.4 语料库加载器 (CorpusLoader)
- 位于: `src/data/corpus_loader.py`
- 功能:
  - 加载组织后的语料库数据
  - 提供数据访问接口
  - 支持多种数据格式

### 2. 数据层

#### 2.1 语料库数据
- 位于: `data/organized/`
- 包含:
  - 中文人名库
  - 古代人名库
  - 成语词典
  - 姓氏库
  - 主题名字库
  - 其他数据（称呼关系、诗词名字等）

#### 2.2 缓存管理
- 位于: `src/utils/cache_manager.py`
- 功能:
  - 提供内存和文件双重缓存
  - 支持缓存过期机制
  - 提高系统响应速度

### 3. Web界面

#### 3.1 Flask应用
- 位于: `src/web/app.py`
- 功能:
  - 提供RESTful API接口
  - 实现Web界面展示
  - 处理用户请求和响应

#### 3.2 前端页面
- 位于: `src/web/templates/`
- 包含:
  - 首页 (index.html)
  - 错误页面 (404.html, 500.html)

### 4. 配置管理

#### 4.1 系统配置
- 位于: `config/settings.py`
- 包含:
  - 应用基础设置
  - 开发/生产/测试环境配置
  - 日志和缓存配置

#### 4.2 提示词模板
- 位于: `config/prompts.py`
- 功能:
  - 提供多种提示词模板
  - 支持语料库增强提示词

### 5. 工具模块

#### 5.1 数据组织工具
- 位于: `tools/data_organizer.py`
- 功能:
  - 处理原始语料库数据
  - 生成组织后的数据结构

#### 5.2 Excel转换器
- 位于: `tools/excel_converter.py`
- 功能:
  - 将Excel格式的语料库转换为系统可用格式

## 系统流程

### 1. 姓名生成流程
1. 用户通过Web界面或API提供角色描述和选项
2. 姓名生成器接收请求并处理参数
3. 语料库增强器根据描述增强提示词
4. 统一API客户端调用合适的大模型API
5. 生成结果返回给用户并缓存

### 2. 语料库处理流程
1. 原始语料库数据通过工具处理
2. 语料库加载器加载组织后的数据
3. 语料库增强器提供数据访问接口
4. 姓名生成器使用语料库数据增强生成质量

## 技术栈

- 后端: Python 3.13, Flask
- 前端: HTML5, CSS3, JavaScript, Bootstrap 5
- 数据处理: pandas, numpy, jieba, pypinyin
- 测试: pytest
- 部署: 支持虚拟环境部署

## 部署说明

1. 安装依赖: `pip install -r requirements.txt`
2. 配置环境变量: 复制 `.env.example` 为 `.env` 并填写相应配置
3. 运行应用: `python src/web/app.py`
4. 访问应用: http://localhost:5000

## 测试

- 单元测试: `python -m pytest tests/`
- 集成测试: 包含语料库集成测试

## 未来扩展

1. 支持更多大模型平台
2. 增加更多语料库类型
3. 提供批量生成功能
4. 增加用户管理系统
5. 提供API文档和SDK