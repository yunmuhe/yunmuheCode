# 项目架构说明

## 项目组成

本项目由**前后端分离**的两个独立部分组成：

### 1. 后端智能体（NameGenerationAgent）

**位置**：`NameGenerationAgent/`

**技术栈**：
- Python 3.13
- Flask Web框架
- 多平台API集成

**主要功能**：
- 提供RESTful API接口
- 集成6个大模型平台
- 管理120万+人名语料库
- 实现智能降级策略
- 缓存和性能优化

**核心文件**：
```
NameGenerationAgent/
├── main.py                    # 启动入口
├── src/
│   ├── api/                   # API适配器层
│   │   ├── adapters/          # 各平台适配器
│   │   └── unified_client.py  # 统一客户端
│   ├── core/                  # 核心业务逻辑
│   │   ├── name_generator.py  # 姓名生成器
│   │   └── corpus_enhancer.py # 语料库增强
│   ├── data/                  # 数据处理
│   │   └── corpus_loader.py   # 语料库加载
│   ├── utils/                 # 工具模块
│   └── web/                   # Flask应用（测试框架）
│       └── app.py             # 简单的测试界面
├── config/                    # 配置文件
└── tests/                     # 测试文件
```

**说明**：
- `src/web/app.py` 是早期的测试框架，提供简单的Web界面用于测试API
- 主要作用是提供RESTful API服务，供前端调用

### 2. 前端应用（智能姓名生成系统）

**位置**：`智能姓名生成系统/`

**技术栈**：
- uni-app框架（基于Vue 2）
- 支持H5、小程序等多端
- Vite构建工具

**主要功能**：
- 现代化的用户界面
- 响应式设计
- 历史记录管理
- 多端适配（H5/小程序）

**核心文件**：
```
智能姓名生成系统/
├── pages/                     # 页面目录
│   ├── Generate/              # 生成页面
│   │   └── Generate.vue       # 主要生成界面
│   └── ...
├── common/                    # 公共模块
│   └── api.ts                 # API请求封装
├── static/                    # 静态资源
├── App.vue                    # 应用入口
├── main.js                    # 主入口文件
├── pages.json                 # 页面配置
├── manifest.json              # 应用配置
└── package.json               # 依赖配置
```

**说明**：
- 这是正式的前端应用，提供完整的用户体验
- 通过HTTP API调用后端服务
- 支持多端部署（H5、微信小程序等）

## 架构关系

```
┌─────────────────────────────────────────┐
│         前端应用（uni-app）              │
│      智能姓名生成系统/                   │
│                                         │
│  ┌──────────────────────────────────┐  │
│  │  Generate.vue (生成页面)         │  │
│  │  - 用户输入                       │  │
│  │  - 参数选择                       │  │
│  │  - 结果展示                       │  │
│  └──────────────┬───────────────────┘  │
│                 │                       │
│  ┌──────────────▼───────────────────┐  │
│  │  common/api.ts (API封装)         │  │
│  │  - HTTP请求                       │  │
│  │  - 错误处理                       │  │
│  └──────────────┬───────────────────┘  │
└─────────────────┼───────────────────────┘
                  │ HTTP API
                  │ (http://127.0.0.1:5000)
┌─────────────────▼───────────────────────┐
│      后端智能体（Flask）                 │
│      NameGenerationAgent/               │
│                                         │
│  ┌──────────────────────────────────┐  │
│  │  Flask路由 (src/web/app.py)      │  │
│  │  - /generate (生成姓名)          │  │
│  │  - /options (获取选项)           │  │
│  │  - /health (健康检查)            │  │
│  └──────────────┬───────────────────┘  │
│                 │                       │
│  ┌──────────────▼───────────────────┐  │
│  │  NameGenerator (核心逻辑)        │  │
│  │  - 构建提示词                     │  │
│  │  - 调用API                        │  │
│  │  - 解析结果                       │  │
│  └──────────────┬───────────────────┘  │
│                 │                       │
│  ┌──────────────▼───────────────────┐  │
│  │  UnifiedAPIClient (API调度)      │  │
│  │  - 多平台适配器                   │  │
│  │  - 智能降级                       │  │
│  │  - 缓存管理                       │  │
│  └──────────────┬───────────────────┘  │
│                 │                       │
│  ┌──────────────▼───────────────────┐  │
│  │  API适配器层                      │  │
│  │  - AliyunAdapter                  │  │
│  │  - SiliconFlowAdapter             │  │
│  │  - BaiduAdapter                   │  │
│  │  - PaiouAdapter                   │  │
│  │  - AIStudioAdapter                │  │
│  │  - BaishanAdapter                 │  │
│  └──────────────┬───────────────────┘  │
└─────────────────┼───────────────────────┘
                  │
                  ▼
         各大模型平台API
```

## API接口说明

### 后端提供的API

#### 1. 生成姓名
```
POST /generate
Content-Type: application/json

请求体：
{
  "description": "角色描述",
  "count": 5,
  "cultural_style": "chinese_modern",
  "gender": "male",
  "age": "adult",
  "preferred_api": "paiou"
}

响应：
{
  "success": true,
  "names": [
    {
      "name": "张明轩",
      "meaning": "明亮轩昂，寓意光明磊落"
    }
  ],
  "api_name": "paiou",
  "cached": false
}
```

#### 2. 获取选项
```
GET /options

响应：
{
  "cultural_styles": ["chinese_modern", "chinese_traditional", ...],
  "genders": ["male", "female", "neutral"],
  "ages": ["child", "adult", "elder"],
  "apis": ["paiou", "aistudio", "aliyun", ...]
}
```

#### 3. 健康检查
```
GET /health

响应：
{
  "status": "healthy",
  "timestamp": "2025-11-26T10:00:00"
}
```

## 部署架构

### 开发环境

```
开发者电脑
├── 后端服务
│   └── http://127.0.0.1:5000 (Flask)
│
└── 前端开发服务器
    └── http://localhost:5173 (Vite)
```

### 生产环境（建议）

```
服务器
├── 后端服务
│   ├── Nginx反向代理
│   ├── Gunicorn/uWSGI
│   └── Flask应用
│
└── 前端静态文件
    ├── Nginx静态服务
    └── 构建后的H5文件
```

## 数据流

1. **用户操作** → 前端界面输入角色描述和参数
2. **前端请求** → `common/api.ts` 发送HTTP请求到后端
3. **后端接收** → Flask路由接收请求
4. **业务处理** → NameGenerator处理请求
5. **API调用** → UnifiedAPIClient调用大模型API
6. **结果返回** → 后端返回JSON响应
7. **前端展示** → 前端解析并展示结果

## 技术特点

### 前端（uni-app）
- ✅ 跨平台支持（H5、小程序）
- ✅ Vue 2生态
- ✅ 响应式设计
- ✅ 组件化开发
- ✅ 统一的API封装

### 后端（Flask）
- ✅ RESTful API设计
- ✅ 适配器模式
- ✅ 多平台集成
- ✅ 智能降级
- ✅ 缓存优化

### 通信
- ✅ HTTP/HTTPS协议
- ✅ JSON数据格式
- ✅ CORS跨域支持
- ✅ 错误处理机制

## 开发流程

### 启动后端
```bash
cd NameGenerationAgent
python main.py
# 服务运行在 http://127.0.0.1:5000
```

### 启动前端
```bash
cd 智能姓名生成系统
npm install
npm run dev:h5
# 服务运行在 http://localhost:5173
```

### 配置CORS
在 `NameGenerationAgent/.env` 中配置：
```env
ALLOWED_ORIGINS=http://localhost:5173,http://127.0.0.1:5173
```

## 版本控制

### 后端
- Git仓库：主项目仓库
- 分支：master
- 提交：4次提交，100个文件

### 前端
- Git仓库：独立仓库（`智能姓名生成系统/.git`）
- 独立管理，不纳入主项目版本控制

## 总结

本项目采用**前后端分离**架构：

- **后端**：提供API服务，负责业务逻辑和AI集成
- **前端**：提供用户界面，负责交互和展示
- **通信**：通过RESTful API进行数据交互

这种架构的优势：
1. ✅ 前后端独立开发和部署
2. ✅ 前端可以多端适配（H5、小程序等）
3. ✅ 后端可以服务多个前端应用
4. ✅ 技术栈独立，易于维护和升级
5. ✅ 职责清晰，便于团队协作
